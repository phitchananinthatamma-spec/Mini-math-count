<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>COUNT RAID : NEON HACK</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#000;
  color:#00ffe7;
  font-family: 'Segoe UI', sans-serif;
  text-align:center;
}
.container{
  max-width:420px;
  margin:40px auto;
  padding:20px;
  border:2px solid #00ffe7;
  box-shadow:0 0 20px #00ffe7;
  border-radius:12px;
}
h1{
  text-shadow:0 0 10px #00ffe7;
}
input,button{
  width:90%;
  padding:12px;
  margin:8px 0;
  background:#000;
  border:1px solid #00ffe7;
  color:#00ffe7;
  font-size:16px;
}
button{
  cursor:pointer;
}
button:hover{
  background:#00ffe7;
  color:#000;
}
.hidden{display:none;}
.player{
  border-bottom:1px solid #00ffe7;
  padding:5px;
}
.answer-btn{
  display:block;
  margin:6px auto;
}
.correct{color:#00ff00;}
.wrong{color:#ff0044;}
</style>
</head>

<body>

<div class="container" id="menu">
  <h1>üß† COUNT RAID</h1>
  <p>NEON HACK MODE</p>
  <input id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô">
  <button onclick="createRoom()">üöÄ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á</button>
  <input id="roomCode" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á">
  <button onclick="joinRoom()">üîë ‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á</button>
</div>

<div class="container hidden" id="lobby">
  <h2>üîí ‡∏´‡πâ‡∏≠‡∏á <span id="roomText"></span></h2>
  <div id="players"></div>
  <button onclick="startGame()">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
</div>

<div class="container hidden" id="game">
  <h2 id="question"></h2>
  <div id="answers"></div>
  <p id="feedback"></p>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getDatabase, ref, set, push, onValue, update } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAScwLSlNF1i0cAAT-xadJTFOgGUEsIilk",
  authDomain: "count-raid-game.firebaseapp.com",
  databaseURL: "https://count-raid-game-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "count-raid-game",
  storageBucket: "count-raid-game.firebasestorage.app",
  messagingSenderId: "887793946867",
  appId: "1:887793946867:web:14c0c60399fcefc8612786"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

let roomId = "";
let playerId = "";
let qIndex = 0;

const questions = [
  {q:"‡∏°‡∏µ‡πÄ‡∏™‡∏∑‡πâ‡∏≠ 3 ‡∏ï‡∏±‡∏ß ‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á 2 ‡∏ï‡∏±‡∏ß ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà‡πÅ‡∏ö‡∏ö",a:["5","6","8"],c:1},
  {q:"‡πÄ‡∏•‡∏Ç 1‚Äì4 ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏•‡∏Ç 2 ‡∏´‡∏•‡∏±‡∏Å‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô",a:["12","16","6"],c:0},
  {q:"‡πÇ‡∏¢‡∏ô‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç 3 ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç ‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏µ‡πà‡πÅ‡∏ö‡∏ö",a:["6","8","9"],c:1},
  {q:"A B C ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏°‡∏≤ 2 ‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÑ‡∏î‡πâ‡∏Å‡∏µ‡πà‡πÅ‡∏ö‡∏ö",a:["6","3","2"],c:0},
  {q:"‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 4 ‡∏ó‡∏≤‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏µ‡∏Å‡∏Ç‡∏±‡πâ‡∏ô 5 ‡∏ó‡∏≤‡∏á ‡∏°‡∏µ‡∏Å‡∏µ‡πà‡∏ß‡∏¥‡∏ò‡∏µ",a:["20","9","25"],c:0}
];

window.createRoom = ()=>{
  const name=document.getElementById("name").value.trim();
  if(!name) return alert("‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô");
  roomId=Math.random().toString(36).substring(2,6).toUpperCase();
  playerId=Date.now().toString();
  set(ref(db,"rooms/"+roomId),{
    started:false,
    q:0
  });
  set(ref(db,"rooms/"+roomId+"/players/"+playerId),{
    name,score:0
  });
  enterLobby();
};

window.joinRoom = ()=>{
  const name=document.getElementById("name").value.trim();
  roomId=document.getElementById("roomCode").value.trim().toUpperCase();
  if(!name||!roomId) return alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö");
  playerId=Date.now().toString();
  set(ref(db,"rooms/"+roomId+"/players/"+playerId),{
    name,score:0
  });
  enterLobby();
};

function enterLobby(){
  menu.classList.add("hidden");
  lobby.classList.remove("hidden");
  roomText.innerText=roomId;
  onValue(ref(db,"rooms/"+roomId+"/players"),snap=>{
    players.innerHTML="";
    snap.forEach(p=>{
      players.innerHTML+=`<div class="player">${p.val().name} : ${p.val().score}</div>`;
    });
  });
  onValue(ref(db,"rooms/"+roomId+"/started"),s=>{
    if(s.val()) startRound();
  });
}

window.startGame=()=>{
  update(ref(db,"rooms/"+roomId),{started:true});
};

function startRound(){
  lobby.classList.add("hidden");
  game.classList.remove("hidden");
  loadQuestion();
}

function loadQuestion(){
  if(qIndex>=questions.length){
    feedback.innerHTML="üèÅ ‡∏à‡∏ö‡πÄ‡∏Å‡∏° <br><button onclick='location.reload()'>‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>";
    return;
  }
  const q=questions[qIndex];
  question.innerText=q.q;
  answers.innerHTML="";
  feedback.innerText="";
  q.a.forEach((text,i)=>{
    const b=document.createElement("button");
    b.className="answer-btn";
    b.innerText=text;
    b.onclick=()=>check(i);
    answers.appendChild(b);
  });
}

function check(i){
  const q=questions[qIndex];
  if(i===q.c){
    feedback.innerHTML="<span class='correct'>‚úî ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</span>";
    update(ref(db,"rooms/"+roomId+"/players/"+playerId+"/score"),prev=> (prev||0)+10);
  }else{
    feedback.innerHTML="<span class='wrong'>‚úñ ‡∏ú‡∏¥‡∏î (‡πÄ‡∏â‡∏•‡∏¢: "+q.a[q.c]+")</span>";
  }
  qIndex++;
  setTimeout(loadQuestion,1200);
}
</script>

</body>
</html>
